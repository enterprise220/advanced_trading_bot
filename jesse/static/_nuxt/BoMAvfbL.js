import{g as M,R as F,r as h,o as i,c as d,b as u,F as D,m as J,$ as A,d as n,w as k,t as I,U as z,B as r,X as G,Y as H,Z as K,a1 as V,f as X,W as Y,D as Z,G as Q,i as x,H as ee,j as te,k as se,C as v,P as _,J as B,q as L,e as oe,K as T,v as re,M as ne,N as ae,z as le,S as ie}from"./Dl48H-cf.js";import{r as ue}from"./EV21_tF2.js";import{_ as de,a as ce,b as me,c as pe}from"./CDZc91Rq.js";import{_ as ge}from"./BTdtwO3f.js";import{u as fe}from"./DCynXvCa.js";const be={class:"mb-4"},ye={class:"hidden sm:block"},ve={class:"relative rounded-lg shadow flex divide-x divide-gray-200 dark:divide-gray-700","aria-label":"props.Tabs"},_e=["onMouseup"],he=["data-cy","onClick"],ke={class:"absolute right-[1em] focus:outline-none"},xe=M({__name:"CandleTabs",props:{tabs:{}},emits:["close"],setup(w,{emit:l}){const c=F(),m=h(c.params.id),p=l,g=w;function b(s){if(s.results.exception.error&&s.results.executing)return"Error";let o="";return s.form.exchange&&(o+=`${s.form.exchange} • `),s.form.symbol&&(o+=`${s.form.symbol.toUpperCase()} • `),s.form.start_date&&(o+=`${s.form.start_date}`),o=o.endsWith(" • ")?o.slice(0,-3):o,s.results.executing?`${o} | ${s.results.progressbar.current}%`:o}return(s,o)=>{const y=X,$=Y;return i(),d("div",be,[u("div",ye,[u("nav",ve,[(i(!0),d(D,null,J(g.tabs,(f,U,R)=>(i(),d("div",{key:f.id,class:"relative group min-w-0 flex-1 overflow-hidden text-center flex items-center",onMouseup:A(S=>p("close",f.id),["middle"])},[n(y,{to:`/candles/${f.id}`,class:z([f.id===r(m)?"text-gray-900 dark:text-gray-100 font-bold ":"text-gray-500 dark:text-gray-300 hover:text-gray-700 font-medium ","py-3 px-4 inline-block select-none cursor-pointer focus:outline-none w-full text-xs bg-gray-50 dark:bg-backdrop-dark"])},{default:k(()=>[u("span",null,I(b(f)),1),u("span",{"aria-hidden":"true",class:z([f.id===r(m)&&Object.keys(g.tabs).length>1?"bg-indigo-400":"bg-transparent dark:bg-gray-600","absolute inset-x-0 bottom-0 h-0.5"])},null,2)]),_:2},1032,["to","class"]),G(u("button",{"data-cy":"tab-close-button"+R,class:"absolute right-[1em] focus:outline-none",onClick:S=>p("close",f.id)},[n(r(K),{class:"h-5 w-5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 hover:bg-gray-200 bg-gray-100 dark:bg-gray-700 rounded-full","aria-hidden":"true"})],8,he),[[H,Object.keys(g.tabs).length>1]])],40,_e))),128)),n($,{text:"New Tab",popper:{arrow:!0}},{default:k(()=>[u("div",{class:"select-none cursor-pointer text-gray-400 dark:text-gray-100 hover:text-gray-600 focus:outline-none group relative w-14 overflow-hidden bg-gray-50 dark:bg-backdrop-dark py-3 px-4 font-medium hover:bg-gray-50 dark:hover:bg-gray-800 flex items-center justify-center",onClick:o[0]||(o[0]=f=>r(V)().addTab())},[u("button",ke,[n(r(ue),{class:"h-6 w-6 rounded-full","aria-hidden":"true"})]),o[1]||(o[1]=u("span",{"aria-hidden":"true",class:"absolute inset-x-0 bottom-0 h-0.5 bg-transparent dark:bg-gray-600"},null,-1))])]),_:1})])])])}}}),we={key:0,class:"flex flex-col items-center justify-center select-none mt-[10%]"},$e=["textContent"],Se={class:"mt-8"},Ce={key:1,class:"mx-auto container mt-8"},Te={key:0,class:"mb-8"},Ve={key:1,class:"pb-4"},Re={key:0},Ee={key:0},Ne={key:1},Me=M({__name:"CandlesTab",props:{form:{},results:{}},setup(w){const l=w,c=h([]),m=h(""),p=V(),g=Z(),b=Q(),s=h([]);async function o(){s.value=await g.getExchangeSupportedSymbols(l.form.exchange),s.value.includes(l.form.symbol)||(l.form.symbol=s.value[0])}const y=h(!1),$=x(()=>g.backtestingExchangeNames);l.form.exchange=l.form.exchange||$.value[0];const f=x(()=>ee.remainingTimeText(l.results.progressbar.estimated_remaining_seconds)),U=e=>{S()&&p.start(e)},R=e=>{S()&&p.startInNewTab(e)};function S(){const e={mustContainDashErrorMessage:'Symbol parameter must contain "-" character!',emptySymbolErrorMessage:"Symbol parameter cannot be empty"};return l.form.exchange?l.form.symbol?l.form.symbol.includes("-")?l.form.start_date?!0:(T("error","Start date parameter cannot be empty"),!1):(T("error",e.mustContainDashErrorMessage),!1):(T("error",e.emptySymbolErrorMessage),!1):(T("error","Exchange parameter cannot be empty"),!1)}return te(()=>m.value,e=>{if(e.length==0){c.value=[];return}const t=[];for(const C of s.value){if(t.length>50)break;C.toLowerCase().startsWith(e.toLowerCase())&&t.push(C)}c.value=t}),se(()=>{setTimeout(()=>{o()},100)}),(e,t)=>{const C=de,E=re,q=ce,O=me,N=ne,j=ge,P=ae,W=pe;return!e.form.debug_mode&&e.results.executing&&!e.results.showResults?(i(),d("div",we,[u("div",null,[n(C,{progress:e.results.progressbar.current},null,8,["progress"])]),e.results.exception.error?v("",!0):(i(),d("h3",{key:0,class:"mt-8 animate-pulse",textContent:I(r(f))},null,8,$e)),u("div",Se,[n(E,{color:"gray",ui:{color:{gray:{solid:"text-rose-500 dark:text-rose-400"}}},class:"w-64 flex justify-center",icon:"i-heroicons-no-symbol",size:"xl",variant:"solid",label:"Cancel",trailing:!1,onClick:t[0]||(t[0]=a=>r(p).cancel((e._.provides[_]||e.$route).params.id))})]),e.results.exception.error&&e.results.executing?(i(),d("div",Ce,[n(q,{modelValue:r(y),"onUpdate:modelValue":t[1]||(t[1]=a=>B(y)?y.value=a:null),title:e.results.exception.error,content:e.results.exception.traceback,mode:"candles"},null,8,["modelValue","title","content"])])):v("",!0)])):(i(),L(W,{key:1},{left:k(()=>[e.results.alert.message?(i(),d("div",Te,[n(O,{color:"teal",icon:"i-heroicons-check-circle",variant:"soft",title:e.results.alert.message,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"white",variant:"link"},onClose:t[2]||(t[2]=a=>e.results.alert.message="")},null,8,["title"])])):v("",!0),!e.results.executing&&!e.results.showResults?(i(),d("div",Ve,[n(N,{title:"Exchange"}),n(j,{modelValue:e.form.exchange,"onUpdate:modelValue":t[3]||(t[3]=a=>e.form.exchange=a),searchable:"",placeholder:"Select an exchange...",options:r($),size:"lg",class:"mt-2",onChange:o},null,8,["modelValue","options"]),n(N,{title:"Symbol",class:"mt-16"}),n(j,{modelValue:e.form.symbol,"onUpdate:modelValue":t[4]||(t[4]=a=>e.form.symbol=a),query:r(m),"onUpdate:query":t[5]||(t[5]=a=>B(m)?m.value=a:null),"clear-search-on-close":"",class:"mt-2",searchable:"",size:"lg",options:r(c),placeholder:"Select a symbol...",onChange:t[6]||(t[6]=a=>m.value="")},{empty:k(()=>t[12]||(t[12]=[oe("Start typing...")])),_:1},8,["modelValue","query","options"]),n(N,{title:"Start Date",class:"mt-16"}),n(P,{modelValue:e.form.start_date,"onUpdate:modelValue":t[7]||(t[7]=a=>e.form.start_date=a),type:"date",size:"lg",class:"mt-2"},null,8,["modelValue"])])):v("",!0)]),right:k(()=>[e.results.executing?v("",!0):(i(),d("div",Re,[e.results.showResults?(i(),d("div",Ee,[u("button",{class:"font-medium select-none items-center px-2.5 py-1.5 border border-transparent rounded shadow-sm text-white bg-indigo-600 dark:bg-indigo-400 hover:bg-indigo-700 dark:hover:bg-indigo-300 focus:outline-none dark:text-black text-base tracking-wide text-center block w-full mb-4",onClick:t[8]||(t[8]=a=>r(b).rerun((e._.provides[_]||e.$route).params.id))}," Rerun "),u("button",{class:"btn-secondary text-center block w-full mb-4",onClick:t[9]||(t[9]=a=>r(b).newBacktest((e._.provides[_]||e.$route).params.id))}," New backtest ")])):(i(),d("div",Ne,[n(E,{class:"w-full flex justify-center",icon:"i-heroicons-bolt",size:"xl",variant:"solid",label:"Start",trailing:!1,onClick:t[10]||(t[10]=a=>U((e._.provides[_]||e.$route).params.id))}),n(E,{class:"w-full flex justify-center mt-4",color:"gray",icon:"i-heroicons-plus",size:"xl",variant:"solid",label:"Start in a new tab",trailing:!1,onClick:t[11]||(t[11]=a=>R((e._.provides[_]||e.$route).params.id))})]))]))]),_:1}))}}}),Ue={class:"w-full"},Le=M({__name:"[id]",setup(w){fe({title:"Candles - Jesse"});const l=V(),c=x(()=>l.tabs),m=le(),p=x(()=>m.params.id),g=x(()=>{if(!c.value[p.value]){const b=Object.keys(c.value);if(b.length>0){const s=c.value[b[0]];return ie().push(`/candles/${s.id}`),s}else V().addTab()}return c.value[p.value]});return(b,s)=>{const o=xe,y=Me;return i(),d(D,null,[u("div",Ue,[n(o,{"page-id":r(p),tabs:r(c),onClose:r(l).closeTab},null,8,["page-id","tabs","onClose"])]),r(g)?(i(),L(y,{key:0,form:r(g).form,results:r(g).results},null,8,["form","results"])):v("",!0)],64)}}});export{Le as default};
