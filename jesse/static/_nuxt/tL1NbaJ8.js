import{_ as E}from"./DA3XN7Ie.js";import{o as i,c,b as r,h as T,V as R,s as I,r as $,D as o,E as F,t as S,W as x,d as s,F as j,n as B,K as U,I as J,j as A,k as G,w as v,X as p,y as K,Y as L,e as O,v as N}from"./zaJoKCRM.js";import{u as W}from"./DbuFO1j8.js";import{r as M}from"./7tvQ_0LX.js";import"./CGqqXpHc.js";function q(_,t){return i(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})])}const X={class:"relative"},Y=["onClick"],H={class:"w-full text-sm text-left"},P={key:0},Q=T({__name:"MultipleSelect",props:R({options:{type:Array,required:!0},animate:{type:Boolean,default:!1}},{modelValue:{type:Array,default:[]},modelModifiers:{}}),emits:["update:modelValue"],setup(_){const t=I(_,"modelValue"),V=_,n=$(!1);function C(u){return t.value.some(d=>d.key===u.key)}function m(u){const d=t.value.findIndex(g=>g.key===u.key);d===-1?t.value.push(u):t.value.splice(d,1)}return(u,d)=>(i(),c("div",X,[o(n)?(i(),c("div",{key:0,class:"fixed inset-0 w-screen z-10",onClick:d[0]||(d[0]=g=>n.value=!o(n))})):F("",!0),r("button",{class:x(["relative min-w-40 xl:min-w-52 w-full bg-white dark:bg-gray-800 flex justify-between items-center px-2 py-0.5 rounded-md border-[2px] border-gray-300 dark:border-gray-900",o(n)?"z-20":""]),onClick:d[1]||(d[1]=g=>n.value=!o(n))},[r("div",null,S(t.value.length)+" selected ",1),r("div",{class:x(["transition-all duration-200",o(n)?"-rotate-180":"rotate-0"])},[s(o(q),{class:"h-3 w-3 text-gray-400 dark:text-gray-600"})],2)],2),r("div",{class:x(["absolute w-full max-h-60 overflow-y-scroll top-9 bg-white dark:bg-gray-800 right-0 rounded-md border-[2px] border-gray-300 dark:border-gray-900 z-20 p-0.5",_.animate?o(n)?"transition-all h-60 opacity-100":"transition-all h-0 opacity-0 pointer-events-none":o(n)?"h-60":"h-0 opacity-0"])},[(i(!0),c(j,null,B(V.options,g=>(i(),c("button",{key:g.key,class:"w-full flex justify-between items-center hover:bg-gray-100 hover:dark:bg-gray-800 p-1 rounded-md",onClick:z=>m(g)},[r("div",H,S(g.label),1),C(g)?(i(),c("div",P,[s(o(U),{class:"h-4 w-4 text-gray-600 dark:text-gray-400"})])):F("",!0)],8,Y))),128))],2)]))}}),Z={class:"relative"},ee=["onClick"],te={class:"w-full text-sm text-left"},re={key:0},oe=T({__name:"SingleSelect",props:R({options:{type:Array,required:!0},animate:{type:Boolean,default:!1}},{modelValue:{type:Object,default:{}},modelModifiers:{}}),emits:["update:modelValue"],setup(_){const t=I(_,"modelValue"),V=_,n=$(!1);function C(m){t.value.key=m.key,t.value.label=m.label}return(m,u)=>(i(),c("div",Z,[o(n)?(i(),c("div",{key:0,class:"fixed inset-0 w-screen z-10",onClick:u[0]||(u[0]=d=>n.value=!o(n))})):F("",!0),r("button",{class:x(["relative min-w-40 xl:min-w-52 w-full bg-white dark:bg-gray-800 flex justify-between items-center px-2 py-0.5 rounded-md border-[2px] border-gray-300 dark:border-gray-900",o(n)?"z-20":""]),onClick:u[1]||(u[1]=d=>n.value=!o(n))},[r("div",null,S(t.value.label),1),r("div",{class:x(["transition-all duration-200",o(n)?"-rotate-180":"rotate-0"])},[s(o(q),{class:"h-3 w-3 text-gray-400 dark:text-gray-600"})],2)],2),r("div",{class:x(["absolute w-full max-h-60 overflow-y-scroll top-9 bg-white dark:bg-gray-800 right-0 rounded-md border-[2px] border-gray-300 dark:border-gray-900 z-20 p-0.5",_.animate?o(n)?"transition-all h-60 opacity-100":"transition-all h-0 opacity-0 pointer-events-none":o(n)?"h-60":"h-0 opacity-0"])},[(i(!0),c(j,null,B(V.options,d=>(i(),c("button",{key:d.key,class:"w-full flex justify-between items-center hover:bg-gray-100 hover:dark:bg-gray-800 p-1 rounded-md",onClick:g=>C(d)},[r("div",te,S(d.label),1),d.key==t.value.key?(i(),c("div",re,[s(o(U),{class:"h-4 w-4 text-gray-600 dark:text-gray-400"})])):F("",!0)],8,ee))),128))],2)]))}}),ae={class:"w-full"},ne={class:"mt-8 p-4"},se={class:"lg:flex justify-center items-center mb-4"},le={class:"md:flex justify-center items-center mb-4 lg:mb-0"},ie={class:"flex justify-center items-center mb-4 md:mb-0"},de=r("div",{class:"font-bold whitespace-nowrap mr-4"},"Filter by:",-1),ce={class:"flex justify-center items-center md:ml-4"},ue=r("div",{class:"font-bold whitespace-nowrap mr-4"},"Sort by:",-1),pe={class:"flex justify-center items-center lg:ml-4"},me=r("div",{class:"font-bold mr-4"},"Actions:",-1),ye={class:"flex"},ge={class:"flex flex-col border-r-2 dark:border-gray-900 font-bold"},be=r("div",{class:"border-b-2 dark:border-gray-900 h-20"},null,-1),fe={class:"flex overflow-x-auto"},_e={class:"px-4 flex items-center justify-center border-b border-t-2 dark:border-gray-900 h-20 bg-white dark:bg-backdrop-dark"},ke={class:"text-gray-700 dark:text-gray-300 truncate"},$e=T({__name:"benchmark",setup(_){W({title:"Benchmark"});const t=J(),V=A(()=>t.tabs),n=$(t.benchmarkColumns),C=$(t.benchmarkSorts);t.benchmarkFilters.length===0&&t.setBenchmarkFilters(n.value);const m=$(JSON.parse(JSON.stringify(t.benchmarkFilters)));Object.keys(t.benchmarkSelectedSort).length==0&&t.setBenchmarkSort(C.value[0]);const u=$(t.benchmarkSelectedSort),d=A(()=>{var b,k,h;const w=t.tabs,y=[];for(const f in w){const l=w[f],e={id:l.id,strategy:((b=l.form.routes[0])==null?void 0:b.strategy)??"",start_date:l.form.start_date,finish_date:l.form.finish_date,fast_mode:l.form.fast_mode,exchange:l.form.exchange,symbol:((k=l.form.routes[0])==null?void 0:k.symbol)??"",timeframe:((h=l.form.routes[0])==null?void 0:h.timeframe)??""},a=l.results.metrics;Object.keys(a).length>0&&(e.total_closed_trades=a.total,e.net_profit=p.round(a.net_profit,1),e.net_profit_percentage=`${p.round(a.net_profit_percentage,1)} %`,e.total_paid_fees=p.round(a.fee,1),e.max_drawdown=`${p.round(a.max_drawdown,1)} %`,e.annual_return=`${p.round(a.annual_return,1)} %`,e.expectancy=`${p.round(a.expectancy_percentage,1)} %`,e.ratio_avg_win_loss=p.round(a.ratio_avg_win_loss,1),e.win_rate=`${p.round(a.win_rate*100,1)} %`,e.longs_percentage=`${p.round(a.longs_percentage,1)} %`,e.shorts_percentage=`${p.round(a.shorts_percentage,1)} %`,e.average_holding_hours=p.round(a.average_holding_period/3600,1),e.sharpe_ratio=p.round(a.sharpe_ratio,1),e.sortino_ratio=p.round(a.sortino_ratio,1),e.calmar_ratio=p.round(a.calmar_ratio,1),e.omega_ratio=p.round(a.omega_ratio,1)),l.results.executing&&!l.results.exception.error?(e.progress=`${l.results.progressbar.current}%`,e.status="running"):l.results.exception.error&&l.results.executing?(e.progress="❌",e.status="error"):Object.keys(a).length===0?e.status="":(e.progress="✅",e.status="finished"),y.push(e)}return y}),g=A(()=>u.value.key=="none"?d.value:[...d.value].sort((w,y)=>{const b=u.value.key,k=parseFloat(w[b])||null,h=parseFloat(y[b])||null;return k===null&&h===null?0:k===null?1:h===null||k>h?-1:k<h?1:0}));function z(){m.value.sort((w,y)=>n.value.findIndex(b=>b.key===w.key)-n.value.findIndex(b=>b.key===y.key)),t.setBenchmarkFilters(m.value)}return G(m,z,{deep:!0}),(w,y)=>{const b=E,k=Q,h=oe,f=K,l=L;return i(),c(j,null,[r("div",ae,[s(b,{"current-tab":null,tabs:V.value,mode:"backtest",onClose:o(t).closeTab},null,8,["tabs","onClose"])]),r("div",ne,[r("div",se,[r("div",le,[r("div",ie,[de,s(k,{modelValue:m.value,"onUpdate:modelValue":y[0]||(y[0]=e=>m.value=e),options:n.value},null,8,["modelValue","options"])]),r("div",ce,[ue,s(h,{modelValue:u.value,"onUpdate:modelValue":y[1]||(y[1]=e=>u.value=e),options:C.value},null,8,["modelValue","options"])])]),r("div",pe,[me,s(f,{icon:"i-heroicons-arrow-path",onClick:o(t).rerunAll},{default:v(()=>[O("Rerun All")]),_:1},8,["onClick"]),s(f,{icon:"i-heroicons-arrow-path",class:"ml-4",color:"rose",onClick:o(t).rerunFailed},{default:v(()=>[O(" Rerun Failed Only ")]),_:1},8,["onClick"]),s(f,{icon:"i-heroicons-stop",class:"ml-4",color:"gray",onClick:o(t).cancelAllRunning},{default:v(()=>[O(" Cancel All ")]),_:1},8,["onClick"])])]),r("div",null,[r("div",ye,[r("div",ge,[be,(i(!0),c(j,null,B(m.value,(e,a)=>(i(),c("div",{key:e.key,class:x(["text-sm uppercase border-b border-l dark:border-gray-900 min-w-[13rem] min-h-[4rem] flex items-center justify-center",a%2===0?"bg-gray-50 dark:bg-gray-800":"bg-white dark:bg-backdrop-dark"])},[r("span",null,S(e.label),1)],2))),128))]),r("div",fe,[(i(!0),c(j,null,B(g.value,e=>(i(),c("div",{key:e.id,class:"flex flex-col border-r dark:border-gray-900"},[r("div",_e,[s(l,{text:"Rerun","open-delay":500,popper:{arrow:!0}},{default:v(()=>[s(f,{class:"mr-2",variant:"ghost",icon:"i-heroicons-arrow-path",disabled:e.status==="running",onClick:a=>o(t).rerun(e.id)},null,8,["disabled","onClick"])]),_:2},1024),s(l,{text:"Go to backtest page","open-delay":500,popper:{arrow:!0}},{default:v(()=>[s(f,{to:`/backtest/${e.id}`,class:"mr-2",variant:"ghost",color:"gray",icon:"i-heroicons-arrow-top-right-on-square"},null,8,["to"])]),_:2},1024),s(l,{text:"Duplicate","open-delay":500,popper:{arrow:!0}},{default:v(()=>[s(f,{class:"mr-2",variant:"ghost",icon:"i-heroicons-document-duplicate",color:"blue",onClick:a=>o(t).duplicateTab(e.id)},null,8,["onClick"])]),_:2},1024),e.status==="running"?(i(),N(l,{key:0,text:"Cancel","open-delay":500,popper:{arrow:!0}},{default:v(()=>[s(f,{variant:"ghost",icon:"i-heroicons-stop",color:"gray",onClick:a=>o(t).cancel(e.id)},null,8,["onClick"])]),_:2},1024)):(i(),N(l,{key:1,text:"Close tab","open-delay":500,popper:{arrow:!0}},{default:v(()=>[s(f,{variant:"ghost",icon:"i-heroicons-trash",color:"red",disabled:Object.keys(g.value).length==1,onClick:a=>o(t).closeTab(e.id)},null,8,["disabled","onClick"])]),_:2},1024))]),(i(!0),c(j,null,B(m.value,(a,D)=>(i(),c("div",{key:a.key,class:x(["border-b dark:border-gray-900 min-w-[6rem] text-center min-h-[4rem] w-[13em]",e.status==="running"?"animate-pulse":""])},[r("div",{class:x(["px-4 py-4 w-full h-full truncate flex items-center justify-center",D%2===0?"bg-gray-50 dark:bg-gray-800":"bg-white dark:bg-backdrop-dark"])},[r("span",ke,S(e[a.key]||"-"),1)],2)],2))),128))]))),128)),s(l,{text:"Add New Tab","open-delay":500,popper:{arrow:!0}},{default:v(()=>[r("button",{class:"w-20 h-full px-4 flex flex-col justify-between items-center border-dashed border-2 dark:border-gray-900 bg-white hover:bg-gray-50 dark:bg-backdrop-dark hover:dark:bg-gray-800 py-10",onClick:y[2]||(y[2]=e=>o(t).addTab())},[s(o(M),{class:"h-6 w-6 text-gray-400 dark:text-gray-100"}),s(o(M),{class:"h-6 w-6 text-gray-400 dark:text-gray-100"}),s(o(M),{class:"h-6 w-6 text-gray-400 dark:text-gray-100"})])]),_:1})])])])])],64)}}});export{$e as default};
