import{_ as N}from"./kkGgV2Mv.js";import{_ as D}from"./BPOHiSmx.js";import{h as P,I as U,j as v,r as x,k as W,o as _,c as g,b as r,d as o,D as i,w as p,F as k,n as w,V as n,y as E,W as L,e as C,X as R,t as O,v as V}from"./Dihhweii.js";import{u as I}from"./Bhe2eH2z.js";import{r as S}from"./CVy80Bx7.js";const M={class:"w-full"},H={class:"mt-8 p-4"},q={class:"lg:flex justify-center items-center mb-4"},z={class:"md:flex justify-center items-center mb-4 lg:mb-0"},G={class:"flex justify-center items-center mb-4 md:mb-0"},X=r("div",{class:"font-bold whitespace-nowrap mr-4"},"Filter by:",-1),J={class:"flex justify-center items-center md:ml-4"},K=r("div",{class:"font-bold whitespace-nowrap mr-4"},"Sort by:",-1),Q={class:"flex justify-center items-center lg:ml-4"},Y=r("div",{class:"font-bold mr-4"},"Actions:",-1),Z={class:"flex"},ee={class:"flex flex-col border-r-2 font-bold"},te=r("div",{class:"border-b-2 h-20"},null,-1),ae={class:"flex overflow-x-auto"},re={class:"px-4 flex items-center justify-center border-b border-t-2 h-20 bg-white dark:bg-backdrop-dark"},oe={class:"text-gray-700 dark:text-gray-300 truncate"},ue=P({__name:"benchmark",setup(le){I({title:"Benchmark"});const c=U(),B=v(()=>c.tabs),h=[{key:"strategy",label:"Strategy"},{key:"progress",label:"Progress"},{key:"start_date",label:"Start Date"},{key:"finish_date",label:"Finish Date"},{key:"exchange",label:"Exchange"},{key:"symbol",label:"Symbol"},{key:"timeframe",label:"Timeframe"},{key:"total_closed_trades",label:"Total Trades"},{key:"net_profit",label:"Net Profit"},{key:"net_profit_percentage",label:"Net Profit %"},{key:"max_drawdown",label:"Max Drawdown"},{key:"sharpe_ratio",label:"Sharpe Ratio"},{key:"sortino_ratio",label:"Sortino Ratio"},{key:"calmar_ratio",label:"Calmar Ratio"},{key:"omega_ratio",label:"Omega Ratio"},{key:"annual_return",label:"Annual Return"},{key:"total_paid_fees",label:"Total Paid Fees"},{key:"expectancy",label:"Expectancy"},{key:"ratio_avg_win_loss",label:"Ratio Avg Win Loss"},{key:"win_rate",label:"Win Rate"},{key:"longs_percentage",label:"Longs %"},{key:"shorts_percentage",label:"Shorts %"},{key:"average_holding_hours",label:"Average Holding Hours"}],$=[{value:"none",label:"None"},{value:"total_closed_trades",label:"Total Trades"},{value:"net_profit",label:"Net Profit"},{value:"net_profit_percentage",label:"Net Profit %"},{value:"sharpe_ratio",label:"Sharpe Ratio"},{value:"sortino_ratio",label:"Sortino Ratio"},{value:"calmar_ratio",label:"Calmar Ratio"},{value:"omega_ratio",label:"Omega Ratio"},{value:"annual_return",label:"Annual Return"},{value:"expectancy",label:"Expectancy"},{value:"ratio_avg_win_loss",label:"Ratio Avg Win Loss"},{value:"win_rate",label:"Win Rate"}],T=x([...h]),f=x([...h]),y=x($[0]),j=v(()=>{var d,u,l;const m=c.tabs,s=[];for(const b in m){const e=m[b],t={id:e.id,strategy:((d=e.form.routes[0])==null?void 0:d.strategy)??"",start_date:e.form.start_date,finish_date:e.form.finish_date,fast_mode:e.form.fast_mode,exchange:e.form.exchange,symbol:((u=e.form.routes[0])==null?void 0:u.symbol)??"",timeframe:((l=e.form.routes[0])==null?void 0:l.timeframe)??""},a=e.results.metrics;Object.keys(a).length>0&&(t.total_closed_trades=a.total,t.net_profit=n.round(a.net_profit,1),t.net_profit_percentage=`${n.round(a.net_profit_percentage,1)} %`,t.total_paid_fees=n.round(a.fee,1),t.max_drawdown=`${n.round(a.max_drawdown,1)} %`,t.annual_return=`${n.round(a.annual_return,1)} %`,t.expectancy=`${n.round(a.expectancy_percentage,1)} %`,t.ratio_avg_win_loss=n.round(a.ratio_avg_win_loss,1),t.win_rate=`${n.round(a.win_rate*100,1)} %`,t.longs_percentage=`${n.round(a.longs_percentage,1)} %`,t.shorts_percentage=`${n.round(a.shorts_percentage,1)} %`,t.average_holding_hours=n.round(a.average_holding_period/3600,1),t.sharpe_ratio=n.round(a.sharpe_ratio,1),t.sortino_ratio=n.round(a.sortino_ratio,1),t.calmar_ratio=n.round(a.calmar_ratio,1),t.omega_ratio=n.round(a.omega_ratio,1)),e.results.executing&&!e.results.exception.error?(t.progress=`${e.results.progressbar.current}%`,t.status="running"):e.results.exception.error&&e.results.executing?(t.progress="❌",t.status="error"):Object.keys(a).length===0?t.status="":(t.progress="✅",t.status="finished"),s.push(t)}return s}),A=v(()=>y.value.value==="none"?j.value:[...j.value].sort((m,s)=>{const d=y.value.value,u=parseFloat(m[d])||null,l=parseFloat(s[d])||null;return u===null&&l===null?0:u===null?1:l===null||u>l?-1:u<l?1:0}));function F(){f.value.sort((m,s)=>T.value.findIndex(d=>d.key===m.key)-T.value.findIndex(d=>d.key===s.key))}return W(f,F,{deep:!0}),(m,s)=>{const d=N,u=D,l=E,b=L;return _(),g(k,null,[r("div",M,[o(d,{"current-tab":null,tabs:B.value,mode:"backtest",onClose:i(c).closeTab},null,8,["tabs","onClose"])]),r("div",H,[r("div",q,[r("div",z,[r("div",G,[X,o(u,{modelValue:f.value,"onUpdate:modelValue":s[0]||(s[0]=e=>f.value=e),class:"w-48",options:h,multiple:"",placeholder:"Columns"},null,8,["modelValue"])]),r("div",J,[K,o(u,{modelValue:y.value,"onUpdate:modelValue":s[1]||(s[1]=e=>y.value=e),class:"w-48",options:$,placeholder:"Sort by"},null,8,["modelValue"])])]),r("div",Q,[Y,o(l,{icon:"i-heroicons-arrow-path",onClick:i(c).rerunAll},{default:p(()=>[C(" Rerun All ")]),_:1},8,["onClick"]),o(l,{icon:"i-heroicons-arrow-path",class:"ml-4",color:"rose",onClick:i(c).rerunFailed},{default:p(()=>[C(" Rerun Failed Only ")]),_:1},8,["onClick"]),o(l,{icon:"i-heroicons-stop",class:"ml-4",color:"gray",onClick:i(c).cancelAllRunning},{default:p(()=>[C(" Cancel All ")]),_:1},8,["onClick"])])]),r("div",null,[r("div",Z,[r("div",ee,[te,(_(!0),g(k,null,w(f.value,(e,t)=>(_(),g("div",{key:e.key,class:R(["text-sm uppercase border-b min-w-[13rem] min-h-[4rem] border-l flex items-center justify-center",t%2===0?"bg-white dark:bg-backdrop-dark":"bg-gray-50 dark:bg-gray-800"])},[r("span",null,O(e.label),1)],2))),128))]),r("div",ae,[(_(!0),g(k,null,w(A.value,e=>(_(),g("div",{key:e.id,class:"flex flex-col border-r"},[r("div",re,[o(b,{text:"Rerun","open-delay":500,popper:{arrow:!0}},{default:p(()=>[o(l,{class:"mr-2",variant:"ghost",icon:"i-heroicons-arrow-path",disabled:e.status==="running",onClick:t=>i(c).rerun(e.id)},null,8,["disabled","onClick"])]),_:2},1024),o(b,{text:"Go to backtest page","open-delay":500,popper:{arrow:!0}},{default:p(()=>[o(l,{to:`/backtest/${e.id}`,class:"mr-2",variant:"ghost",color:"gray",icon:"i-heroicons-arrow-top-right-on-square"},null,8,["to"])]),_:2},1024),o(b,{text:"Duplicate","open-delay":500,popper:{arrow:!0}},{default:p(()=>[o(l,{class:"mr-2",variant:"ghost",icon:"i-heroicons-document-duplicate",color:"blue",onClick:t=>i(c).duplicateTab(e.id)},null,8,["onClick"])]),_:2},1024),e.status==="running"?(_(),V(b,{key:0,text:"Cancel","open-delay":500,popper:{arrow:!0}},{default:p(()=>[o(l,{variant:"ghost",icon:"i-heroicons-stop",color:"gray",onClick:t=>i(c).cancel(e.id)},null,8,["onClick"])]),_:2},1024)):(_(),V(b,{key:1,text:"Close tab","open-delay":500,popper:{arrow:!0}},{default:p(()=>[o(l,{variant:"ghost",icon:"i-heroicons-trash",color:"red",disabled:Object.keys(A.value).length==1,onClick:t=>i(c).closeTab(e.id)},null,8,["disabled","onClick"])]),_:2},1024))]),(_(!0),g(k,null,w(f.value,(t,a)=>(_(),g("div",{key:t.key,class:R(["border-b min-w-[6rem] text-center min-h-[4rem] w-[13em]",e.status==="running"?"animate-pulse":""])},[r("div",{class:R(["px-4 py-4 w-full h-full truncate flex items-center justify-center",a%2===0?"bg-white dark:bg-backdrop-dark":"bg-gray-50 dark:bg-gray-800"])},[r("span",oe,O(e[t.key]||"-"),1)],2)],2))),128))]))),128)),o(b,{text:"Add New Tab","open-delay":500,popper:{arrow:!0}},{default:p(()=>[r("button",{class:"w-20 h-full px-4 flex flex-col justify-between items-center border-dashed border-2 bg-white hover:bg-gray-50 dark:bg-backdrop-dark hover:dark:bg-gray-800 py-10",onClick:s[2]||(s[2]=e=>i(c).addTab())},[o(i(S),{class:"h-6 w-6 text-gray-400 dark:text-gray-100"}),o(i(S),{class:"h-6 w-6 text-gray-400 dark:text-gray-100"}),o(i(S),{class:"h-6 w-6 text-gray-400 dark:text-gray-100"})])]),_:1})])])])])],64)}}});export{ue as default};
